// ADD THIS CODE AT LINE 817 (right after: console.log(`ğŸ“‹ Using base structured response prompt`);)

    // ğŸ“š Add document context if documentId is provided
    if (documentId) {
      const searchResult = searchChunks(documentId, prompt);
      if (searchResult) {
        const documentContextSection = `
${"=".repeat(60)}
ğŸ“„ DOCUMENT CONTEXT
${"=".repeat(60)}

Summary: ${searchResult.summary}

Relevant Sections:
${searchResult.relevantChunks.join("\n\n")}

${"=".repeat(60)}
`;
        enhancedPrompt = documentContextSection + "\n\n" + enhancedPrompt;
        console.log(`ğŸ“š Added document context to prompt. Chunks: ${searchResult.relevantChunks.length}`);
      } else {
        console.warn(`âš ï¸ Document ID "${documentId}" provided but not found in cache.`);
      }
    }
